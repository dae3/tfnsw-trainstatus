pipeline {
	agent none
	parameters { 
		string(name: 'Environment', defaultValue: 'dev', description: 'target environment name')
	}

	stages {
		stage('build') {
			agent {
				docker {
					image 'node:10-alpine'
					args '-p 3000:3000'
				}
			}
			steps {
				dir('formatAlertForPush') {
					sh 'npm install'
				} 
			}
		}
		stage('deploy') {
			agent {
				docker {
					image 'mesosphere/aws-cli'
				}
			}
			steps {
				dir('formatAlertForPush') {
					sh 'zip add formatAlertForPush.zip *.json *.js node_modules/*'

				}
			}
		}
	}
}
